<div class="row mt-2">
  <div class="col-md-4 my-auto">
    <input type="text" [(ngModel)]="searchParam.searchParam" name="searchParam" class="form-control input-search-admin" placeholder="Tìm Kiếm"
    (keyup)="txtSearch($event)">
  </div>
  <div class="col-md-2">
    <button class="btn btn-success w-150">Tìm kiếm</button>
  </div>
  <div class="col-md-5"></div>
  <!-- <div class="col-md-1">
    <button type="button" class="btn btn-success w-100" (click)="open(content)">Add</button>
  </div> -->
</div>

<div class="row mt-2">
  <div class="col">
    <div class="view-title">Tài khoản</div>
    <ngx-datatable class="material selection-cell datatable table-shadow" [rows]='accounts' [columnMode]='"force"'
      [headerHeight]='50' [footerHeight]='50' [rowHeight]='"auto"' [limit]="5" [sorts]="[{prop: 'accountId', dir: 'asc'}]" #accountTable>
      <ngx-datatable-column name="accountId" [width]="50" prop="accountId">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Account Id</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          {{value}}
        </ng-template>
      </ngx-datatable-column>
      <!-- <ngx-datatable-column name="password" [width]="100" prop="password">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Password</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          {{value}}
        </ng-template>
      </ngx-datatable-column> -->
      <ngx-datatable-column name="email" [width]="150" prop="email">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Email</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          {{value}}
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="phoneNumber" [width]="100" prop="phoneNumber">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Phone Number</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          {{value}}
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="fullName" [width]="100" prop="fullName">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Tên người dùng</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          {{value}}
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column [width]="80">
        <ng-template let-column="column" ngx-datatable-header-template>
          <span>
            <strong>Số tiền nợ</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
          <div *ngFor="let i of balance">
            <div *ngIf="row.accountId == i.accountId">
              {{i.debt== null?'Không nợ':'i.debt'}}
            </div>
          </div>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="action" [width]="150" [maxWidth]="150">
        <ng-template let-column="colmun" ngx-datatable-header-template>
          <span>
            <strong>Thao tác</strong>
          </span>
        </ng-template>
        <ng-template ngx-datatable-cell-template class="text-center" let-value="value" let-row="row">
          <button type="button" class="btn btn-info button-custom-admin" (click)="open(contentBalanceHis);getAccountManById(row.accountId);">
            <i class=" fa fa-eye "></i>
          </button>
          <button type="button" class="btn btn-info button-custom-admin ml-2" (click)="open(contentBalance);getBalanceById(row.accountId);">
            <i class=" fa fa-balance-scale " style="color:blue;"></i>
          </button>
          <button type="button" class="btn btn-info button-custom-admin ml-2" (click)="open(contentExchange);getBalanceById(row.accountId);getAccountManById(row.accountId);">
            <i class=" fa fa-exchange " style="color:red;"></i>
          </button>
        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>
  </div>
</div>


<!-- ======================================= Modal ========================================== -->
<ng-template #contentBalanceHis let-c="close " let-d="dismiss">
  <div class="modal-header ">
    <h3 class="modal-title " id="modal-basic-title ">Xem lịch sử giao dịch</h3>
    <button class="close " aria-label="Close " (click)="d( 'Cross click') ">
      <span aria-hidden="true ">&times;</span>
    </button>
  </div>
  <div class="modal-body ">
    <app-balance-his [accountManModel]="accountById" (closeForm)="c('')"></app-balance-his>
  </div>
</ng-template>


<!-- ======================================= Modal ========================================== -->
<ng-template #contentBalance let-c="close " let-d="dismiss">
  <div class="modal-header ">
    <h3 class="modal-title " id="modal-basic-title ">Xem cân đối thu chi</h3>
    <button class="close " aria-label="Close " (click)="d( 'Cross click') ">
      <span aria-hidden="true ">&times;</span>
    </button>
  </div>
  <div class="modal-body ">
    <app-balance [balanceModel]="balanceById" (closeForm)="c('')"></app-balance>
  </div>
</ng-template>


<!-- ======================================= Modal ========================================== -->
<ng-template #contentExchange let-c="close " let-d="dismiss">
  <div class="modal-header ">
    <h3 class="modal-title " id="modal-basic-title ">Giao dịch</h3>
    <button class="close " aria-label="Close " (click)="d( 'Cross click') ">
      <span aria-hidden="true ">&times;</span>
    </button>
  </div>
  <div class="modal-body ">
    <app-exchange [balanceModel]="balanceById" [accountManModel]="accountById" (closeForm)="c('')"></app-exchange>
  </div>
</ng-template>


<pre>{{closeResult}}</pre>